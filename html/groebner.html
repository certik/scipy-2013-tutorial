

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Applications of Gröbner bases &mdash; SymPy tutorial at SciPy 2011 conferences</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://localhost:8080/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://localhost:8080/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://localhost:8080/static/external/ext-core.js"></script>
    <script type="text/javascript" src="http://localhost:8080/static/live-core.js"></script>
    <script type="text/javascript" src="http://localhost:8080/static/live-sphinx.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="SymPy tutorial at SciPy 2011 conferences" href="index.html" />
    <link rel="up" title="Mathematical problem solving with SymPy" href="mathematics.html" />
    <link rel="next" title="Algebraic geometry" href="geometry.html" />
    <link rel="prev" title="Summing roots of polynomials" href="summation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="geometry.html" title="Algebraic geometry"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="summation.html" title="Summing roots of polynomials"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" accesskey="U">Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="applications-of-groebner-bases">
<span id="groebner-bases"></span><h1>Applications of Gröbner bases<a class="headerlink" href="#applications-of-groebner-bases" title="Permalink to this headline">¶</a></h1>
<p>The Gröbner bases method is an attractive tool in computer algebra and
symbolic mathematics because it is relatively simple to understand and it
can be applied to a wide variety of problems in mathematics and engineering.</p>
<p>Let&#8217;s consider a set <span class="math">\(F\)</span> of multivariate polynomial equations over a field:</p>
<div class="math">
\[F = \{ f \in \mathrm{K}[x_1, \ldots, x_n] \}\]</div>
<p>A Gröbner basis <span class="math">\(G\)</span> of <span class="math">\(F\)</span> with respect to a fixed ordering of monomials
is another set of polynomial equations with certain <em>nice</em> properties that
depend on the choice of the order of monomials and variables. <span class="math">\(G\)</span> will be
structurally different from <span class="math">\(F\)</span>, but has exactly the same set of solutions.</p>
<p>The Gröbner bases theory tells us that:</p>
<ol class="arabic simple">
<li>problems that are difficult to solve using <span class="math">\(F\)</span> are <em>easier</em> to solve using <span class="math">\(G\)</span></li>
<li>there exists an <em>algorithm</em> for computing <span class="math">\(G\)</span> for arbitrary <span class="math">\(F\)</span></li>
</ol>
<p>We will take advantage of this and in the following subsections we will solve
two interesting problems in graph theory and algebraic geometry by formulating
those problems as systems of polynomial equations, computing Gröbner bases,
and reading solutions from them.</p>
<div class="section" id="vertex-coloring-of-graphs">
<h2>Vertex <span class="math">\(k\)</span>&#8211;coloring of graphs<a class="headerlink" href="#vertex-coloring-of-graphs" title="Permalink to this headline">¶</a></h2>
<p>Given a graph <span class="math">\(\mathcal{G}(V, E)\)</span>, where <span class="math">\(V\)</span> is the set of vertices and <span class="math">\(E\)</span>
is the set of edges of <span class="math">\(\mathcal{G}\)</span>, and a positive integer <span class="math">\(k\)</span>, we ask if
it is possible to assign a color to every vertex from <span class="math">\(V\)</span>, such that adjacent
vertices have different colors assigned. Moreover, if graph <span class="math">\(\mathcal{G}\)</span> is
<span class="math">\(k\)</span>&#8211;colorable, we would like to enumerate all possible <span class="math">\(k\)</span>&#8211;colorings this
graph.</p>
<p>We will solve this problem using the Gröbner bases method. First of all, we
have to transform this graph&#8211;theoretical definition of <span class="math">\(k\)</span>&#8211;coloring problem
into a form that is understandable by the Gröbner bases machinery. This means
we have to construct a system of polynomial equations that embeds the structure
of a graph and constraints related to the <span class="math">\(k\)</span>&#8211;coloring problem.</p>
<p>We start by assigning a variable to each vertex. Given that <span class="math">\(\mathcal{G}\)</span> has
<span class="math">\(n\)</span> vertices, i.e. <span class="math">\(|V| = n\)</span>, then we will introduce variables <span class="math">\(x_1, \ldots,
x_n\)</span>. Next we will write a set of equations describing the fact that we allow
assignment of one of <span class="math">\(k\)</span> possible colors to each vertex. The best approach
currently known is to map colors to the <span class="math">\(k\)</span>&#8211;th roots of unity, which are the
solutions to the equation <span class="math">\(x^k - 1 = 0\)</span>.</p>
<p>Let <span class="math">\(\zeta = \exp(\frac{2\pi\mathrm{i}}{k})\)</span> be a <span class="math">\(k\)</span>&#8211;th root of unity.
We map the colors <span class="math">\(1, \ldots, k\)</span> to <span class="math">\(1, \zeta, \ldots, \zeta^{k-1}\)</span>.
Then the statement that every vertex has to be assigned one of <span class="math">\(k\)</span>
colors is equivalent to writing the following set of polynomial
equations:</p>
<div class="math">
\[F_k = \{ x_i^k - 1 = 0 : i = 1, 2, \ldots, n \}\]</div>
<p>We also require that two adjacent vertices <span class="math">\(x_i\)</span> and <span class="math">\(x_j\)</span> are assigned different
colors. From the previous discussion we know that <span class="math">\(x_i^k = 1\)</span> and <span class="math">\(x_j^k = 1\)</span>, so
<span class="math">\(x_i^k = x_j^k\)</span> or, equivalently, <span class="math">\(x_i^k - x_j^k = 0\)</span>. By factorization we obtain
that:</p>
<div class="math">
\[x_i^k - x_j^k = (x_i - x_j) \cdot f(x_i, x_j) = 0\]</div>
<p>where <span class="math">\(f(x_i, x_j)\)</span> is a bivariate polynomial of degree <span class="math">\(k-1\)</span> in both variables.
Since we require that <span class="math">\(x_i \not= x_j\)</span> then <span class="math">\(x_i^k - x_j^k\)</span> can vanish only when
<span class="math">\(f(x_i, x_j) = 0\)</span>. This allows us to write another set of polynomial equations:</p>
<div class="math">
\[F_{\mathcal{G}} = \{ f(x_i, x_j) = 0 : (i, j) \in E \}\]</div>
<p>Next we combine <span class="math">\(F_k\)</span> and <span class="math">\(F_{\mathcal{G}}\)</span> into one system of equations <span class="math">\(F\)</span>. The
graph <span class="math">\(\mathcal{G}(V, E)\)</span> is <span class="math">\(k\)</span>-colorable if the Gröbner basis <span class="math">\(G\)</span> of <span class="math">\(F\)</span> is
non-trivial, i.e., <span class="math">\(G \not= \{1\}\)</span>. If this is not the case, then the graph isn&#8217;t
<span class="math">\(k\)</span>&#8211;colorable. Otherwise the Gröbner basis gives us information about all
possible <span class="math">\(k\)</span>&#8211;colorings of <span class="math">\(\mathcal{G}\)</span>.</p>
<p>Let&#8217;s now focus on a particular <span class="math">\(k\)</span>&#8211;coloring where <span class="math">\(k = 3\)</span>. In this case:</p>
<div class="math">
\[F_3 = \{ x_i^3 - 1 : i = 1, \ldots, n \}\]</div>
<p>Using SymPy&#8217;s built&#8211;in multivariate polynomial factorization routine:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;xi, xj&#39;</span><span class="p">)</span>
<span class="go">(xi, xj)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">xi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">xj</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">          ⎛  2             2⎞</span>
<span class="go">(xi - xj)⋅⎝xi  + xi⋅xj + xj ⎠</span>
</pre></div>
</div>
<p>we derive the set of equations <span class="math">\(F_{\mathcal{G}}\)</span> describing an admissible
<span class="math">\(3\)</span>&#8211;coloring of a graph:</p>
<div class="math">
\[F_{\mathcal{G}} = \{ x_i^2 + x_i x_j + x_j^2 : (i, j) \in E \}\]</div>
<p>At this point it is sufficient to compute the Gröbner basis <span class="math">\(G\)</span> of
<span class="math">\(F = F_3 \cup F_{\mathcal{G}}\)</span> to find out if a graph <span class="math">\(\mathcal{G}\)</span> is
<span class="math">\(3\)</span>&#8211;colorable, or not.</p>
<p>Let&#8217;s see how this procedure works for a particular graph:</p>
<div class="figure align-center" id="fig-graph-nocolor">
<img alt="_images/graph-nocolor.png" src="_images/graph-nocolor.png" />
<p class="caption">The graph <span class="math">\(\mathcal{G}(V, E)\)</span>.</p>
</div>
<p><span class="math">\(\mathcal{G}(V, E)\)</span> has 12 vertices and 23 edges. We ask if the graph is
<span class="math">\(3\)</span>&#8211;colorable. Let&#8217;s first encode <span class="math">\(V\)</span> and <span class="math">\(E\)</span> using Python&#8217;s built&#8211;in
data structures:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">),(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">),(</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)]</span>
</pre></div>
</div>
<p>We encoded the set of vertices as a list of consecutive integers and the
set of edges as a list of tuples of adjacent vertex indices. Next we will
transform the graph into an algebraic form by mapping vertices to variables
and tuples of indices in tuples of variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">V</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">E</span> <span class="p">]</span>
</pre></div>
</div>
<p>As the last step of this construction we write equations for <span class="math">\(F_3\)</span> and
<span class="math">\(F_{\mathcal{G}}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">F3</span> <span class="o">=</span> <span class="p">[</span> <span class="n">xi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">V</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fg</span> <span class="o">=</span> <span class="p">[</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xi</span><span class="o">*</span><span class="n">xj</span> <span class="o">+</span> <span class="n">xj</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">xj</span> <span class="ow">in</span> <span class="n">E</span> <span class="p">]</span>
</pre></div>
</div>
<p>Everything is set following the theoretical introduction, so now we can
compute the Gröbner basis of <span class="math">\(F_3 \cup F_{\mathcal{G}}\)</span> with respect
to <em>lexicographic</em> ordering of terms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">groebner</span><span class="p">(</span><span class="n">F3</span> <span class="o">+</span> <span class="n">Fg</span><span class="p">,</span> <span class="o">*</span><span class="n">V</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;lex&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We know that if the constructed system of polynomial equations has a solution
then <span class="math">\(G\)</span> should be non&#8211;trivial, which can be easily verified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">!=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The answer is that the graph <span class="math">\(\mathcal{G}\)</span> is <span class="math">\(3\)</span>&#8211;colorable. A sample coloring
is shown on the following figure:</p>
<div class="figure align-center" id="fig-graph-color">
<img alt="_images/graph-color.png" src="_images/graph-color.png" />
<p class="caption">A sample <span class="math">\(3\)</span>&#8211;coloring of the graph <span class="math">\(\mathcal{G}(V, E)\)</span>.</p>
</div>
<p>Suppose we add an edge between vertices <span class="math">\(i = 3\)</span> and <span class="math">\(j = 4\)</span>. Is the new graph
still <span class="math">\(3\)</span>&#8211;colorable? To check this it is sufficient to construct <span class="math">\(F_{\mathcal{G'}}\)</span>
by extending <span class="math">\(F_{\mathcal{G}}\)</span> with <span class="math">\(x_3^2 + x_3 x_4 + x_4^2\)</span> and recomputing the
Gröbner basis:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">groebner</span><span class="p">(</span><span class="n">F3</span> <span class="o">+</span> <span class="n">Fg</span> <span class="o">+</span> <span class="p">[</span><span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">*</span><span class="n">x4</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">V</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;lex&#39;</span><span class="p">)</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>We got the trivial Gröbner basis as the result, so the graph <span class="math">\(\mathcal{G'}\)</span>
isn&#8217;t <span class="math">\(3\)</span>&#8211;colorable. We could continue this discussion and ask, for example,
if the original graph <span class="math">\(\mathcal{G}\)</span> can be colored with only two colors. To
achieve this, we would have to construct <span class="math">\(F_2\)</span> and <span class="math">\(F_{\mathcal{G}}\)</span>
and recompute the basis.</p>
<p>Let&#8217;s return to the original graph. We already know that it is <span class="math">\(3\)</span>&#8211;colorable,
but now we would like to enumerate all colorings. We will start from revising
properties of roots of unity. Let&#8217;s construct the <span class="math">\(k\)</span>&#8211;th root of unity, where
<span class="math">\(k = 3\)</span>, in algebraic number form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span>
<span class="go">        ⎽⎽⎽</span>
<span class="go">  1   ╲╱ 3 ⋅ⅈ</span>
<span class="go">- ─ + ───────</span>
<span class="go">  2      2</span>
</pre></div>
</div>
<p>Altogether we consider three roots of unity in this example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span><span class="o">**</span><span class="mi">0</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span><span class="o">**</span><span class="mi">1</span>
<span class="go">        ⎽⎽⎽</span>
<span class="go">  1   ╲╱ 3 ⋅ⅈ</span>
<span class="go">- ─ + ───────</span>
<span class="go">  2      2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">        ⎽⎽⎽</span>
<span class="go">  1   ╲╱ 3 ⋅ⅈ</span>
<span class="go">- ─ - ───────</span>
<span class="go">  2      2</span>
</pre></div>
</div>
<p>Just to be extra cautious, let&#8217;s check if <span class="math">\(\zeta^3\)</span> gives <span class="math">\(1\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">zeta</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Alternatively, we could obtain all <span class="math">\(k\)</span>&#8211;th roots of unity by factorization
of <span class="math">\(x^3 - 1\)</span> over an algebraic number field or by computing its roots via
radicals:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">zeta</span><span class="p">)</span>
<span class="go">        ⎛          ⎽⎽⎽  ⎞ ⎛          ⎽⎽⎽  ⎞</span>
<span class="go">        ⎜    1   ╲╱ 3 ⋅ⅈ⎟ ⎜    1   ╲╱ 3 ⋅ⅈ⎟</span>
<span class="go">(x - 1)⋅⎜x + ─ - ───────⎟⋅⎜x + ─ + ───────⎟</span>
<span class="go">        ⎝    2      2   ⎠ ⎝    2      2   ⎠</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">roots</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">⎡           ⎽⎽⎽            ⎽⎽⎽  ⎤</span>
<span class="go">⎢     1   ╲╱ 3 ⋅ⅈ    1   ╲╱ 3 ⋅ⅈ⎥</span>
<span class="go">⎢1, - ─ - ───────, - ─ + ───────⎥</span>
<span class="go">⎣     2      2       2      2   ⎦</span>
</pre></div>
</div>
<p>We can visualize roots of <span class="math">\(x^3 - 1\)</span> with a little help from mpmath and matplotlib:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy.mpmath</span> <span class="kn">import</span> <span class="n">cplot</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">r&quot;Density plot of $z^3 - 1$ in the complex plane.&quot;</span><span class="p">)</span>

<span class="n">cplot</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">re</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">im</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//groebner-1.py">Source code</a>, <a class="reference external" href=".//groebner-1.png">png</a>, <a class="reference external" href=".//groebner-1.hires.png">hires.png</a>, <a class="reference external" href=".//groebner-1.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/groebner-1.png" src="_images/groebner-1.png" />
</div>
<p>Going one step ahead, let&#8217;s declare three variables which will nicely represent
colors in the <span class="math">\(3\)</span>&#8211;coloring problem and let&#8217;s put together, in an arbitrary but
fixed order, those variables and the previously computed roots of unity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;red,green,blue&#39;</span><span class="p">)</span>
<span class="go">(red, green, blue)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">__</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span>

<span class="go">⎡          ⎛        ⎽⎽⎽         ⎞  ⎛        ⎽⎽⎽        ⎞⎤</span>
<span class="go">⎢          ⎜  1   ╲╱ 3 ⋅ⅈ       ⎟  ⎜  1   ╲╱ 3 ⋅ⅈ      ⎟⎥</span>
<span class="go">⎢(1, red), ⎜- ─ - ───────, green⎟, ⎜- ─ + ───────, blue⎟⎥</span>
<span class="go">⎣          ⎝  2      2          ⎠  ⎝  2      2         ⎠⎦</span>
</pre></div>
</div>
<p>This gives as a mapping between algebra of <span class="math">\(3\)</span>&#8211;coloring problem and a nice
visual representation, which we will take advantage of later.</p>
<p>Let&#8217;s look at <span class="math">\(G\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="p">(</span><span class="n">degree</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sift</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">⎡   3    ⎤</span>
<span class="go">⎣x₁₂  - 1⎦</span>
<span class="go">⎡   2                2⎤</span>
<span class="go">⎣x₁₁  + x₁₁⋅x₁₂ + x₁₂ ⎦</span>
<span class="go">[x₁ + x₁₁ + x₁₂, x₁₁ + x₁₂ + x₅, x₁₁ + x₁₂ + x₈, x₁₀ + x₁₁ + x₁₂]</span>
<span class="go">[-x₁₁ + x₂, -x₁₂ + x₃, -x₁₂ + x₄, -x₁₁ + x₆, -x₁₂ + x₇, -x₁₁ + x₉]</span>
</pre></div>
</div>
<p>Here we split the basis into four groups with respect to the total degree
and length of polynomials. Treating all those polynomials as equations of
the form <span class="math">\(f = 0\)</span>, we can solve them one&#8211;by&#8211;one, to obtain all colorings
of <span class="math">\(\mathcal{G}\)</span>.</p>
<p>From the previous discussion we know that <span class="math">\(x_{12}^3 - 1 = 0\)</span> has three solutions
in terms of roots of unity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">x12</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x12</span><span class="p">,</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x12</span><span class="p">,</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x12</span><span class="p">,</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This also tells us that <span class="math">\(x_{12}\)</span> can have any of the three colors assigned.
Next, the equation <span class="math">\(x_{11}^2 + x_{11} x_{12} + x_{12}^2 = 0\)</span> relates colors
of <span class="math">\(x_{11}\)</span> and <span class="math">\(x_{12}\)</span>, and vanishes only when <span class="math">\(x_{11} \not= x_{12}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">x11</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x11</span><span class="o">*</span><span class="n">x12</span> <span class="o">+</span> <span class="n">x12</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">0</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">0</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>but:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">0</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x11</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x12</span><span class="p">:</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This means that, when <span class="math">\(x_{12}\)</span> is assigned a color, there are two possible
color assignments to <span class="math">\(x_{11}\)</span>. Equations in the third group vanish only when
all three vertices of that particular equation have different colors assigned. This
follows from the fact that the sum of roots of unity vanishes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">zeta</span><span class="o">**</span><span class="mi">0</span> <span class="o">+</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>but (for example):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">zeta</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Finally, equations in the last group are trivial and vanish when vertices of
each particular equation have the same color assigned. This gives us <span class="math">\(3 \cdot 2
\cdot 1 \cdot 1 = 6\)</span> combinations of color assignments, i.e. there are six
solutions to <span class="math">\(3\)</span>&#8211;coloring problem of graph <span class="math">\(\mathcal{G}\)</span>.</p>
<p>Based on this analysis it is straightforward to enumerate all six color
assignments, however we can make this process fully automatic. Let&#8217;s solve
the Gröbner basis <span class="math">\(G\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">colorings</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">*</span><span class="n">V</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">colorings</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>This confirms that there are six solutions. At this point we could simply
print the computed solutions to see what are the admissible <span class="math">\(3\)</span>&#8211;colorings.
This is, however, not a good idea, because we use algebraic numbers (roots
of unity) for representing colors and <tt class="xref py py-func docutils literal"><span class="pre">solve()</span></tt> returned solutions in
terms of those algebraic numbers, possibly even in a non&#8211;simplified form.</p>
<p>To overcome this difficulty we will use previously defined mapping between
roots of unity and literal colors and substitute symbols for numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">coloring</span> <span class="ow">in</span> <span class="n">colorings</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="p">[</span> <span class="n">color</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">coloring</span> <span class="p">]</span>
<span class="gp">...</span>
<span class="go">[blue, green, red, red, blue, green, red, blue, green, blue, green, red]</span>
<span class="go">[green, blue, red, red, green, blue, red, green, blue, green, blue, red]</span>
<span class="go">[green, red, blue, blue, green, red, blue, green, red, green, red, blue]</span>
<span class="go">[blue, red, green, green, blue, red, green, blue, red, blue, red, green]</span>
<span class="go">[red, blue, green, green, red, blue, green, red, blue, red, blue, green]</span>
<span class="go">[red, green, blue, blue, red, green, blue, red, green, red, green, blue]</span>
</pre></div>
</div>
<p>This is the result we were looking for, but a few words of explanation
are needed. <tt class="xref py py-func docutils literal"><span class="pre">solve()</span></tt> may return unsimplified results so we may need
to simplify any algebraic numbers that don&#8217;t match structurally the
precomputed roots of unity. Taking advantage of the domain of
computation, we use the complex expansion algorithm for this purpose
(<tt class="docutils literal"><span class="pre">expand(complex=True)</span></tt>). Once we have the solutions in this canonical
form, to get this nice <em>visual</em> form with literal colors it is
sufficient to substitute color variables for roots of unity.</p>
<div class="section" id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Instead of computing Gröbner basis of <span class="math">\(F\)</span>, simply solve it using
<tt class="xref py py-func docutils literal"><span class="pre">solve()</span></tt>. Can you enumerate color assignments this way? If so, why?</p>
<p>(<a class="reference internal" href="extras.html#solution-colorings-1"><em>solution</em></a>)</p>
</li>
<li><p class="first">Use this procedure to check if:</p>
<ul class="simple">
<li>the graph with 12 vertices and 23 edges is <span class="math">\(2\)</span>&#8211;colorable.</li>
<li>the graph with 12 vertices and 24 edges is <span class="math">\(4\)</span>&#8211;colorable.</li>
</ul>
<p>(<a class="reference internal" href="extras.html#solution-colorings-2"><em>solution</em></a>)</p>
</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/sympy-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Applications of Gröbner bases</a><ul>
<li><a class="reference internal" href="#vertex-coloring-of-graphs">Vertex <span class="math">\(k\)</span>&#8211;coloring of graphs</a><ul>
<li><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="summation.html"
                        title="previous chapter">Summing roots of polynomials</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="geometry.html"
                        title="next chapter">Algebraic geometry</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/groebner.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="geometry.html" title="Algebraic geometry"
             >next</a> |</li>
        <li class="right" >
          <a href="summation.html" title="Summing roots of polynomials"
             >previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" >Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Mateusz Paprocki, Aaron Meurer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>