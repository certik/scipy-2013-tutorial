

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extras &mdash; SymPy tutorial at SciPy conference 2011</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/ext-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="SymPy tutorial at SciPy conference 2011" href="index.html" />
    <link rel="prev" title="Mathematical problem solving with SymPy" href="mathematics.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mathematics.html" title="Mathematical problem solving with SymPy"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy conference 2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="extras">
<h1>Extras<a class="headerlink" href="#extras" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solutions">
<h2>Solutions<a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="arithmetic-operators">
<h3>Arithmetic operators<a class="headerlink" href="#arithmetic-operators" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-1">
<span id="solution-arith-op-1"></span><h4>Solution 1<a class="headerlink" href="#solution-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Poly</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="go"> 10    9    8    7    6    5    4    3    2</span>
<span class="go">x   + x  + x  + x  + x  + x  + x  + x  + x  + x + 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">([</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="go"> 10    9    8    7    6    5    4    3    2</span>
<span class="go">x   + x  + x  + x  + x  + x  + x  + x  + x  + x + 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Poly</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">11</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
<span class="go"> 10    9    8    7    6    5    4    3    2</span>
<span class="go">x   + x  + x  + x  + x  + x  + x  + x  + x  + x + 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_poly_1</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go"> 2</span>
<span class="go">x  + x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go"> 3    2</span>
<span class="go">x  + x  + x + 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_poly_2</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_poly_2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">    1</span>
<span class="go">1 + ─</span>
<span class="go">    x</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-2">
<span id="solution-arith-op-2"></span><h4>Solution 2<a class="headerlink" href="#solution-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">nested_power</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">expr</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">expr</span><span class="o">**</span><span class="n">nested_power</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nested_power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go"> x</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nested_power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go"> ⎛ x⎞</span>
<span class="go"> ⎝x ⎠</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nested_power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go"> ⎛ ⎛ x⎞⎞</span>
<span class="go"> ⎜ ⎝x ⎠⎟</span>
<span class="go"> ⎝x    ⎠</span>
<span class="go">x</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-blocks-of-expressions">
<h3>Building blocks of expressions<a class="headerlink" href="#building-blocks-of-expressions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-blocks-1">
<span id="id1"></span><h4>Solution 1<a class="headerlink" href="#solution-blocks-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">Integral</span><span class="p">,</span> <span class="n">Eq</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,x,C&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, x, C)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expressions</span>
<span class="go">⎡ n     2            1    1      a⋅x              ⎤</span>
<span class="go">⎢x , a⋅x  + b⋅x + c, ─, ──────, ℯ   , b + sin(a⋅x)⎥</span>
<span class="go">⎢                    x   2                        ⎥</span>
<span class="go">⎣                       x  + 1                    ⎦</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">integrals_table</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">integral</span> <span class="o">=</span> <span class="n">Integral</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">integrals_table</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">integral</span><span class="p">,</span> <span class="n">integral</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> <span class="o">+</span> <span class="n">C</span><span class="p">))</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">integral</span><span class="p">,</span> <span class="n">antiderivative</span> <span class="ow">in</span> <span class="n">integrals_table</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">integral</span><span class="p">,</span> <span class="n">antiderivative</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">print</span>
<span class="gp">...</span>
<span class="go">⌠              n + 1</span>
<span class="go">⎮  n          x</span>
<span class="go">⎮ x  dx = C + ──────</span>
<span class="go">⌡             n + 1</span>

<span class="go">⌠                              3      2</span>
<span class="go">⎮ ⎛   2          ⎞          a⋅x    b⋅x</span>
<span class="go">⎮ ⎝a⋅x  + b⋅x + c⎠ dx = C + ──── + ──── + c⋅x</span>
<span class="go">⌡                            3      2</span>

<span class="go">⌠</span>
<span class="go">⎮ 1</span>
<span class="go">⎮ ─ dx = C + log(x)</span>
<span class="go">⎮ x</span>
<span class="go">⌡</span>

<span class="go">⌠</span>
<span class="go">⎮   1</span>
<span class="go">⎮ ────── dx = C + atan(x)</span>
<span class="go">⎮  2</span>
<span class="go">⎮ x  + 1</span>
<span class="go">⌡</span>

<span class="go">⌠                a⋅x</span>
<span class="go">⎮  a⋅x          ℯ</span>
<span class="go">⎮ ℯ    dx = C + ────</span>
<span class="go">⌡                a</span>

<span class="go">⌠                               cos(a⋅x)</span>
<span class="go">⎮ (b + sin(a⋅x)) dx = C + b⋅x - ────────</span>
<span class="go">⌡                                  a</span>

<span class="go">⌠              n + 1</span>
<span class="go">⎮  n          x</span>
<span class="go">⎮ x  dx = C + ──────</span>
<span class="go">⌡             n + 1</span>

<span class="go">⌠                              3      2</span>
<span class="go">⎮ ⎛   2          ⎞          a⋅x    b⋅x</span>
<span class="go">⎮ ⎝a⋅x  + b⋅x + c⎠ dx = C + ──── + ──── + c⋅x</span>
<span class="go">⌡                            3      2</span>
<span class="go">⌠</span>
<span class="go">⎮ 1</span>
<span class="go">⎮ ─ dx = C + log(x)</span>
<span class="go">⎮ x</span>
<span class="go">⌡</span>

<span class="go">⌠</span>
<span class="go">⎮   1</span>
<span class="go">⎮ ────── dx = C + atan(x)</span>
<span class="go">⎮  2</span>
<span class="go">⎮ x  + 1</span>
<span class="go">⌡</span>

<span class="go">⌠                a⋅x</span>
<span class="go">⎮  a⋅x          ℯ</span>
<span class="go">⎮ ℯ    dx = C + ────</span>
<span class="go">⌡                a</span>

<span class="go">⌠                               cos(a⋅x)</span>
<span class="go">⎮ (b + sin(a⋅x)) dx = C + b⋅x - ────────</span>
<span class="go">⌡                                  a</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="foreign-types-in-sympy">
<h3>Foreign types in SymPy<a class="headerlink" href="#foreign-types-in-sympy" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-foreign-1">
<span id="id2"></span><h4>Solution 1<a class="headerlink" href="#solution-foreign-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core.sympify</span> <span class="kn">import</span> <span class="n">sympify</span><span class="p">,</span> <span class="n">converter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gmpy</span> <span class="kn">import</span> <span class="n">mpq</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">mpq_to_Rational</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">Rational</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">numer</span><span class="p">(),</span> <span class="n">obj</span><span class="o">.</span><span class="n">denom</span><span class="p">())</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">converter</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">mpq</span><span class="p">(</span><span class="mi">1</span><span class="p">))]</span> <span class="o">=</span> <span class="n">mpq_to_Rational</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sympify</span><span class="p">(</span><span class="n">mpq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">1/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sympy.core.numbers.Rational&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-foreign-2">
<span id="id3"></span><h4>Solution 2<a class="headerlink" href="#solution-foreign-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core.sympify</span> <span class="kn">import</span> <span class="n">converter</span><span class="p">,</span> <span class="n">sympify</span><span class="p">,</span> <span class="n">SympifyError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">ndarray</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ndarray_to_Tuple</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">obj</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="n">SympifyError</span><span class="p">(</span><span class="s">&quot;only row NumPy arrays are allowed&quot;</span><span class="p">)</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">converter</span><span class="p">[</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndarray_to_Tuple</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sympify</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">Tuple(1, 2, 3)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sympify</span><span class="p">(</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">SympifyError: SympifyError</span>: <span class="n">&#39;only row NumPy arrays are allowed&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-role-of-symbols">
<h3>The role of symbols<a class="headerlink" href="#the-role-of-symbols" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-symbols-1">
<span id="id4"></span><h4>Solution 1<a class="headerlink" href="#solution-symbols-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">numbered_symbols</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_expression_1</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_expression_2</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">X</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">1:</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_expression_3</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">X</span> <span class="o">=</span> <span class="n">numbered_symbols</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">build_expression_1</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="go">       2     3     4     5</span>
<span class="go">x₁ + x₂  + x₃  + x₄  + x₅</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_expression_2</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="go">       2     3     4     5</span>
<span class="go">y₁ + y₂  + y₃  + y₄  + y₅</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_expression_2</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="go">       2     3     4     5</span>
<span class="go">z₁ + z₂  + z₃  + z₄  + z₅</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="obtaining-parts-of-expressions">
<h3>Obtaining parts of expressions<a class="headerlink" href="#obtaining-parts-of-expressions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-parts-1">
<span id="id5"></span><h4>Solution 1<a class="headerlink" href="#solution-parts-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Atom</span><span class="p">,</span> <span class="n">sympify</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">depth_1</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Atom</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">max</span><span class="p">([</span> <span class="n">depth_1</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">depth_1</span><span class="p">(</span><span class="mi">117</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">depth_2</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_depth</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Atom</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">max</span><span class="p">([</span> <span class="n">_depth</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span> <span class="p">])</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">_depth</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">depth_2</span><span class="p">(</span><span class="mi">117</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-parts-2">
<span id="id6"></span><h4>Solution 2<a class="headerlink" href="#solution-parts-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Atom</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Atom</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Basic</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
<span class="gp">... </span>        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;can&#39;t compute the depth of </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">max</span><span class="p">([</span> <span class="n">depth</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">depth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth</span><span class="p">(</span><span class="nb">set</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))]))</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="immutability-of-expressions">
<h3>Immutability of expressions<a class="headerlink" href="#immutability-of-expressions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-immutability-1">
<span id="id7"></span><h4>Solution 1<a class="headerlink" href="#solution-immutability-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">**</span><span class="n">x</span>
<span class="go"> x</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">    ⎛ x⎞</span>
<span class="go">    ⎝x ⎠</span>
<span class="go">⎛ x⎞</span>
<span class="go">⎝x ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">          ⎛    ⎛ x⎞⎞</span>
<span class="go">          ⎜    ⎝x ⎠⎟</span>
<span class="go">          ⎜⎛ x⎞    ⎟</span>
<span class="go">          ⎝⎝x ⎠    ⎠</span>
<span class="go">⎛    ⎛ x⎞⎞</span>
<span class="go">⎜    ⎝x ⎠⎟</span>
<span class="go">⎜⎛ x⎞    ⎟</span>
<span class="go">⎝⎝x ⎠    ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">                      ⎛          ⎛    ⎛ x⎞⎞⎞</span>
<span class="go">                      ⎜          ⎜    ⎝x ⎠⎟⎟</span>
<span class="go">                      ⎜          ⎜⎛ x⎞    ⎟⎟</span>
<span class="go">                      ⎜          ⎝⎝x ⎠    ⎠⎟</span>
<span class="go">                      ⎜⎛    ⎛ x⎞⎞          ⎟</span>
<span class="go">                      ⎜⎜    ⎝x ⎠⎟          ⎟</span>
<span class="go">                      ⎜⎜⎛ x⎞    ⎟          ⎟</span>
<span class="go">                      ⎝⎝⎝x ⎠    ⎠          ⎠</span>
<span class="go">⎛          ⎛    ⎛ x⎞⎞⎞</span>
<span class="go">⎜          ⎜    ⎝x ⎠⎟⎟</span>
<span class="go">⎜          ⎜⎛ x⎞    ⎟⎟</span>
<span class="go">⎜          ⎝⎝x ⎠    ⎠⎟</span>
<span class="go">⎜⎛    ⎛ x⎞⎞          ⎟</span>
<span class="go">⎜⎜    ⎝x ⎠⎟          ⎟</span>
<span class="go">⎜⎜⎛ x⎞    ⎟          ⎟</span>
<span class="go">⎝⎝⎝x ⎠    ⎠          ⎠</span>


<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="o">**</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="o">**</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go">                      ⎛          ⎛    ⎛ x⎞⎞⎞</span>
<span class="go">                      ⎜          ⎜    ⎝x ⎠⎟⎟</span>
<span class="go">                      ⎜          ⎜⎛ x⎞    ⎟⎟</span>
<span class="go">                      ⎜          ⎝⎝x ⎠    ⎠⎟</span>
<span class="go">                      ⎜⎛    ⎛ x⎞⎞          ⎟</span>
<span class="go">                      ⎜⎜    ⎝x ⎠⎟          ⎟</span>
<span class="go">                      ⎜⎜⎛ x⎞    ⎟          ⎟</span>
<span class="go">                      ⎝⎝⎝x ⎠    ⎠          ⎠</span>
<span class="go">⎛          ⎛    ⎛ x⎞⎞⎞</span>
<span class="go">⎜          ⎜    ⎝x ⎠⎟⎟</span>
<span class="go">⎜          ⎜⎛ x⎞    ⎟⎟</span>
<span class="go">⎜          ⎝⎝x ⎠    ⎠⎟</span>
<span class="go">⎜⎛    ⎛ x⎞⎞          ⎟</span>
<span class="go">⎜⎜    ⎝x ⎠⎟          ⎟</span>
<span class="go">⎜⎜⎛ x⎞    ⎟          ⎟</span>
<span class="go">⎝⎝⎝x ⎠    ⎠          ⎠</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="turning-strings-into-expressions">
<h3>Turning strings into expressions<a class="headerlink" href="#turning-strings-into-expressions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-sympify-1">
<span id="id8"></span><h4>Solution 1<a class="headerlink" href="#solution-sympify-1" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="customizing-built-in-printers">
<h3>Customizing built-in printers<a class="headerlink" href="#customizing-built-in-printers" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-custom-printers-1">
<span id="id9"></span><h4>Solution 1<a class="headerlink" href="#solution-custom-printers-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">sin</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.printing.pretty.pretty</span> <span class="kn">import</span> <span class="n">PrettyPrinter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.printing.pretty.stringpict</span> <span class="kn">import</span> <span class="n">prettyForm</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LambdaPrettyPrinter</span><span class="p">(</span><span class="n">PrettyPrinter</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_print_Lambda</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">args</span> <span class="o">+</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],)</span>
<span class="gp">... </span>        <span class="n">pform_head</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="s">&#39;Lambda&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">pform_tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_seq</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="s">&#39;(&#39;</span><span class="p">,</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">pform_head</span><span class="o">.</span><span class="n">right</span><span class="p">(</span><span class="n">pform_tail</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">pform</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">LambdaPrettyPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)))</span>
<span class="go">      ⎛      ⎛1⎞⎞</span>
<span class="go">Lambda⎜x, sin⎜─⎟⎟</span>
<span class="go">      ⎝      ⎝x⎠⎠</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-custom-printers-2">
<span id="id10"></span><h4>Solution 2<a class="headerlink" href="#solution-custom-printers-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.printing.pretty.pretty</span> <span class="kn">import</span> <span class="n">PrettyPrinter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.printing.pretty.stringpict</span> <span class="kn">import</span> <span class="n">prettyForm</span><span class="p">,</span> <span class="n">stringPict</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">PolyPrettyPrinter</span><span class="p">(</span><span class="n">PrettyPrinter</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_print_Poly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">expr</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">gens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">domain</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">stringPict</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">pform</span><span class="p">,</span> <span class="s">&quot;, &quot;</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">stringPict</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">pform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">gen</span><span class="p">)))</span>
<span class="gp">... </span>            <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">stringPict</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">pform</span><span class="p">,</span> <span class="s">&quot;, &quot;</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">stringPict</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">pform</span><span class="p">,</span> <span class="s">&quot;domain=&quot;</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">stringPict</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">pform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">domain</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">pform</span><span class="o">.</span><span class="n">parens</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="n">ifascii_nougly</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">pform</span> <span class="o">=</span> <span class="n">prettyForm</span><span class="p">(</span><span class="o">*</span><span class="n">prettyForm</span><span class="p">(</span><span class="s">&#39;Poly&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">right</span><span class="p">(</span><span class="n">pform</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">pform</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">PolyPrettyPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">    ⎛ 2                 ⎞</span>
<span class="go">Poly⎝x  + 1, x, domain=ℤ⎠</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">PolyPrettyPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">    ⎛ 2   y                ⎞</span>
<span class="go">Poly⎜x  + ─, x, y, domain=ℚ⎟</span>
<span class="go">    ⎝     2                ⎠</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="implementing-printers-from-scratch">
<h3>Implementing printers from scratch<a class="headerlink" href="#implementing-printers-from-scratch" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-new-printers-1">
<span id="id11"></span><h4>Solution 1<a class="headerlink" href="#solution-new-printers-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ExtendedMathematicaPrinter</span><span class="p">(</span><span class="n">MathematicaPrinter</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_print_Pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&#39;Pi&#39;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">MathematicaPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ExtendedMathematicaPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">Pi</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-new-printers-2">
<span id="id12"></span><h4>Solution 2<a class="headerlink" href="#solution-new-printers-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ExtendedMathematicaPrinter</span><span class="p">(</span><span class="n">MathematicaPrinter</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_print_Mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">prec</span> <span class="o">=</span> <span class="n">precedence</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;*&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="bp">self</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span> <span class="p">])</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">MathematicaPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ExtendedMathematicaPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*Sin[x]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="code-generation">
<h3>Code generation<a class="headerlink" href="#code-generation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-codegen-1">
<span id="id13"></span><h4>Solution 1<a class="headerlink" href="#solution-codegen-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.utilities.codegen</span> <span class="kn">import</span> <span class="n">codegen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">chebyshevt</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">codegen</span><span class="p">((</span><span class="s">&quot;chebyshevt_20&quot;</span><span class="p">,</span> <span class="n">chebyshevt</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;file&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">/******************************************************************************</span>
<span class="go"> *                      Code generated with sympy 0.7.0                       *</span>
<span class="go"> *                                                                            *</span>
<span class="go"> *              See http://www.sympy.org/ for more information.               *</span>
<span class="go"> *                                                                            *</span>
<span class="go"> *                       This file is part of &#39;project&#39;                       *</span>
<span class="go"> ******************************************************************************/</span>
<span class="go">#include &quot;file.h&quot;</span>
<span class="go">#include &lt;math.h&gt;</span>

<span class="go">double chebyshevt_20(double x) {</span>

<span class="go">   return 524288*pow(x, 20) - 2621440*pow(x, 18) + 5570560*pow(x, 16) - 6553600*pow(x, 14) + 4659200*pow(x, 12) - 2050048*pow(x, 10) + 549120*pow(x, 8) - 84480*pow(x, 6) + 6600*pow(x, 4) - 200*pow(x, 2) + 1;</span>

<span class="go">}</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-codegen-2">
<span id="id14"></span><h4>Solution 2<a class="headerlink" href="#solution-codegen-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.utilities.codegen</span> <span class="kn">import</span> <span class="n">codegen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">chebyshevt</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">functions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&quot;chebyshevt_</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">chebyshevt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">codegen</span><span class="p">(</span><span class="n">functions</span><span class="p">,</span> <span class="s">&quot;F95&quot;</span><span class="p">,</span> <span class="s">&quot;file&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">!******************************************************************************</span>
<span class="go">!*                      Code generated with sympy 0.7.0                       *</span>
<span class="go">!*                                                                            *</span>
<span class="go">!*              See http://www.sympy.org/ for more information.               *</span>
<span class="go">!*                                                                            *</span>
<span class="go">!*                       This file is part of &#39;project&#39;                       *</span>
<span class="go">!******************************************************************************</span>

<span class="go">REAL*8 function chebyshevt_0()</span>
<span class="go">implicit none</span>

<span class="go">chebyshevt_0 = 1</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_1(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_1 = x</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_2(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_2 = 2*x**2 - 1</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_3(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_3 = 4*x**3 - 3*x</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_4(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_4 = 8*x**4 - 8*x**2 + 1</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_5(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_5 = 16*x**5 - 20*x**3 + 5*x</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_6(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_6 = 32*x**6 - 48*x**4 + 18*x**2 - 1</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_7(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_7 = 64*x**7 - 112*x**5 + 56*x**3 - 7*x</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_8(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_8 = 128*x**8 - 256*x**6 + 160*x**4 - 32*x**2 + 1</span>

<span class="go">end function</span>

<span class="go">REAL*8 function chebyshevt_9(x)</span>
<span class="go">implicit none</span>
<span class="go">REAL*8, intent(in) :: x</span>

<span class="go">chebyshevt_9 = 256*x**9 - 576*x**7 + 432*x**5 - 120*x**3 + 9*x</span>

<span class="go">end function</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="partial-fraction-decomposition">
<h3>Partial fraction decomposition<a class="headerlink" href="#partial-fraction-decomposition" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-partfrac-1">
<span id="id15"></span><h4>Solution 1<a class="headerlink" href="#solution-partfrac-1" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first"><span class="math">\(\frac{3 x + 5}{(2 x + 1)^2}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span><span class="n">f</span>
<span class="go"> 3⋅x + 5</span>
<span class="go">──────────</span>
<span class="go">         2</span>
<span class="go">(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;A:B&#39;</span><span class="p">)</span>
<span class="go">(A, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
<span class="go">⎛   A         B     ⎞</span>
<span class="go">⎜───────, ──────────⎟</span>
<span class="go">⎜2⋅x + 1           2⎟</span>
<span class="go">⎝         (2⋅x + 1) ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">));</span><span class="n">h</span>
<span class="go">   A          B</span>
<span class="go">─────── + ──────────</span>
<span class="go">2⋅x + 1            2</span>
<span class="go">          (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcombined</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">together</span><span class="p">(</span><span class="n">h</span><span class="p">));</span><span class="n">hcombined</span>
<span class="go">2⋅A⋅x + A + B</span>
<span class="go">─────────────</span>
<span class="go">           2</span>
<span class="go">  (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">hcombined</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span><span class="n">eq</span>
<span class="go">2⋅A⋅x + A + B    3⋅x + 5</span>
<span class="go">───────────── = ──────────</span>
<span class="go">           2             2</span>
<span class="go">  (2⋅x + 1)     (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffeq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">));</span><span class="n">eq</span>
<span class="go">2⋅A⋅x + A + B = 3⋅x + 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_undetermined_coeffs</span><span class="p">(</span><span class="n">coeffeq</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">],</span> <span class="n">x</span><span class="p">);</span><span class="n">sol</span>
<span class="go">{A: 3/2, B: 7/2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">);</span><span class="n">solution</span>
<span class="go">     3             7</span>
<span class="go">─────────── + ────────────</span>
<span class="go">2⋅(2⋅x + 1)              2</span>
<span class="go">              2⋅(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">     3             7</span>
<span class="go">─────────── + ────────────</span>
<span class="go">2⋅(2⋅x + 1)              2</span>
<span class="go">              2⋅(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">==</span> <span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first"><span class="math">\(\frac{3 x + 5}{(u x + v)^2}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;u v&#39;</span><span class="p">)</span>
<span class="go">(u, v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span><span class="n">f</span>
<span class="go"> 3⋅x + 5</span>
<span class="go">──────────</span>
<span class="go">         2</span>
<span class="go">(u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;A:B&#39;</span><span class="p">)</span>
<span class="go">(A, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
<span class="go">⎛   A         B     ⎞</span>
<span class="go">⎜───────, ──────────⎟</span>
<span class="go">⎜u⋅x + v           2⎟</span>
<span class="go">⎝         (u⋅x + v) ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">));</span><span class="n">h</span>
<span class="go">   A          B</span>
<span class="go">─────── + ──────────</span>
<span class="go">u⋅x + v            2</span>
<span class="go">          (u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcombined</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">together</span><span class="p">(</span><span class="n">h</span><span class="p">));</span><span class="n">hcombined</span>
<span class="go">A⋅u⋅x + A⋅v + B</span>
<span class="go">───────────────</span>
<span class="go">            2</span>
<span class="go">   (u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">hcombined</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span><span class="n">eq</span>
<span class="go">A⋅u⋅x + A⋅v + B    3⋅x + 5</span>
<span class="go">─────────────── = ──────────</span>
<span class="go">            2              2</span>
<span class="go">   (u⋅x + v)      (u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffeq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">));</span><span class="n">eq</span>
<span class="go">A⋅u⋅x + A⋅v + B    3⋅x + 5</span>
<span class="go">─────────────── = ──────────</span>
<span class="go">            2              2</span>
<span class="go">   (u⋅x + v)      (u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">coeffeq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="n">coeffeq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span>
<span class="go">Poly(A*u*x + A*v + B, x, domain=&#39;ZZ[u,v,A,B]&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhs</span>
<span class="go">Poly(3*x + 5, x, domain=&#39;ZZ&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffeqs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Eq</span><span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">rhs</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">];</span><span class="n">coeffeqs</span>
<span class="go">[A⋅v + B = 5, A⋅u = 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">);</span><span class="n">solution</span>
<span class="go"> 5⋅u - 3⋅v          3</span>
<span class="go">──────────── + ───────────</span>
<span class="go">           2   u⋅(u⋅x + v)</span>
<span class="go">u⋅(u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c"># Note, you must include x!</span>
<span class="go"> 5⋅u - 3⋅v          3</span>
<span class="go">──────────── + ───────────</span>
<span class="go">           2   u⋅(u⋅x + v)</span>
<span class="go">u⋅(u⋅x + v)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">==</span> <span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first"><span class="math">\(\frac{(3 x + 5)^2}{(2 x + 1)^2}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span><span class="n">f</span>
<span class="go">         2</span>
<span class="go">(3⋅x + 5)</span>
<span class="go">──────────</span>
<span class="go">         2</span>
<span class="go">(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Here, deg(p) == deg(q), so we have to use div()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">numer</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">div</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="c"># p = d*q + r, i.e., f = p/q = d + r/q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">r</span>
<span class="go">(9/4, 21⋅x + 91/4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">=</span> <span class="n">d</span> <span class="c"># This is the polynomial part of the solution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;A:B&#39;</span><span class="p">)</span>
<span class="go">(A, B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
<span class="go">⎛   A         B     ⎞</span>
<span class="go">⎜───────, ──────────⎟</span>
<span class="go">⎜2⋅x + 1           2⎟</span>
<span class="go">⎝         (2⋅x + 1) ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">));</span><span class="n">h</span>
<span class="go">   A          B</span>
<span class="go">─────── + ──────────</span>
<span class="go">2⋅x + 1            2</span>
<span class="go">          (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcombined</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">together</span><span class="p">(</span><span class="n">h</span><span class="p">));</span><span class="n">hcombined</span>
<span class="go">2⋅A⋅x + A + B</span>
<span class="go">─────────────</span>
<span class="go">           2</span>
<span class="go">  (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">hcombined</span><span class="p">,</span> <span class="n">r</span><span class="o">/</span><span class="n">q</span><span class="p">);</span><span class="n">eq</span>
<span class="go">2⋅A⋅x + A + B   21⋅x + 91/4</span>
<span class="go">───────────── = ───────────</span>
<span class="go">           2              2</span>
<span class="go">  (2⋅x + 1)      (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffeq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="n">r</span><span class="p">);</span><span class="n">eq</span> <span class="c"># No need to call numer() here; we know it&#39;s r</span>
<span class="go">2⋅A⋅x + A + B   21⋅x + 91/4</span>
<span class="go">───────────── = ───────────</span>
<span class="go">           2              2</span>
<span class="go">  (2⋅x + 1)      (2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffeqs</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">coeffeq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">-</span> <span class="n">coeffeq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span><span class="n">sol</span>
<span class="go">{A: 21/2, B: 49/4}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Note, since we&#39;re just subtracting coeffeq.lhs from coeffeq.rhs, we could have</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># done it without using Eq() in the first place.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">coeffeqs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">+=</span> <span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">);</span><span class="n">solution</span> <span class="c"># Note the +=</span>
<span class="go">9        21            49</span>
<span class="go">─ + ─────────── + ────────────</span>
<span class="go">4   2⋅(2⋅x + 1)              2</span>
<span class="go">                  4⋅(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">9        21            49</span>
<span class="go">─ + ─────────── + ────────────</span>
<span class="go">4   2⋅(2⋅x + 1)              2</span>
<span class="go">                  4⋅(2⋅x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">==</span> <span class="n">apart</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="solution-partfrac-2">
<span id="id16"></span><h4>Solution 2<a class="headerlink" href="#solution-partfrac-2" title="Permalink to this headline">¶</a></h4>
<p>Even though you can use <tt class="xref py py-func docutils literal"><span class="pre">Expr.coeff()</span></tt> to get the coefficient of
<span class="math">\(x^n\)</span> in a polynomial for <span class="math">\(n &gt; 0\)</span>, it will not work for <span class="math">\(n = 0\)</span>. This
is because <tt class="xref py py-func docutils literal"><span class="pre">Expr.coeff()</span></tt> considers any term with no numerical
coefficient to be the coefficient of 1. From the docstring:</p>
<div class="highlight-python"><pre>You can select terms with no rational coefficient:
&gt;&gt;&gt; (x+2*y).coeff(1)
x
&gt;&gt;&gt; (3+2*x+4*x**2).coeff(1)</pre>
</div>
</div>
</div>
<div class="section" id="deriving-trigonometric-identities">
<h3>Deriving trigonometric identities<a class="headerlink" href="#deriving-trigonometric-identities" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-trig-1">
<span id="id17"></span><h4>Solution 1<a class="headerlink" href="#solution-trig-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">);</span><span class="n">f</span>
<span class="go">sin(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">                     2           3           4           5           6           7           8           9</span>
<span class="go">                    a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)</span>
<span class="go">sin(b) + a⋅cos(b) - ───────── - ───────── + ───────── + ───────── - ───────── - ───────── + ───────── + ───────── + O(a**10)</span>
<span class="go">                        2           6           24         120         720         5040       40320       362880</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)])</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">⎛   8      6    4    2    ⎞          ⎛   9       7      5    3    ⎞</span>
<span class="go">⎜  a      a    a    a     ⎟          ⎜  a       a      a    a     ⎟</span>
<span class="go">⎜───── - ─── + ── - ── + 1⎟⋅sin(b) + ⎜────── - ──── + ─── - ── + a⎟⋅cos(b)</span>
<span class="go">⎝40320   720   24   2     ⎠          ⎝362880   5040   120   6     ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sina</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sina</span>
<span class="go">   9       7      5    3</span>
<span class="go">  a       a      a    a</span>
<span class="go">────── - ──── + ─── - ── + a</span>
<span class="go">362880   5040   120   6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sina</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">⎛   8      6    4    2    ⎞</span>
<span class="go">⎜  a      a    a    a     ⎟</span>
<span class="go">⎜───── - ─── + ── - ── + 1⎟⋅sin(b) + sin(a)⋅cos(b)</span>
<span class="go">⎝40320   720   24   2     ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosa</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosa</span>
<span class="go">   8      6    4    2</span>
<span class="go">  a      a    a    a</span>
<span class="go">───── - ─── + ── - ── + 1</span>
<span class="go">40320   720   24   2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">sin(a)⋅cos(b) + sin(b)⋅cos(a)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span>
<span class="go">sin(a + b) = sin(a)⋅cos(b) + sin(b)⋅cos(a)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-trig-2">
<span id="id18"></span><h4>Solution 2<a class="headerlink" href="#solution-trig-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">);</span><span class="n">f</span>
<span class="go">cos(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">                     2           3           4           5           6           7           8           9</span>
<span class="go">                    a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)   a ⋅cos(b)   a ⋅sin(b)</span>
<span class="go">cos(b) - a⋅sin(b) - ───────── + ───────── + ───────── - ───────── - ───────── + ───────── + ───────── - ───────── + O(a**10)</span>
<span class="go">                        2           6           24         120         720         5040       40320       362880</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)])</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">⎛   8      6    4    2    ⎞          ⎛     9       7      5    3    ⎞</span>
<span class="go">⎜  a      a    a    a     ⎟          ⎜    a       a      a    a     ⎟</span>
<span class="go">⎜───── - ─── + ── - ── + 1⎟⋅cos(b) + ⎜- ────── + ──── - ─── + ── - a⎟⋅sin(b)</span>
<span class="go">⎝40320   720   24   2     ⎠          ⎝  362880   5040   120   6     ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sina</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sina</span>
<span class="go">   9       7      5    3</span>
<span class="go">  a       a      a    a</span>
<span class="go">────── - ──── + ─── - ── + a</span>
<span class="go">362880   5040   120   6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Note that subs will not work directly with sina, because -sina appears</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># in g.  We get around it by substituting -sina.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="o">-</span><span class="n">sina</span><span class="p">,</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">⎛   8      6    4    2    ⎞</span>
<span class="go">⎜  a      a    a    a     ⎟</span>
<span class="go">⎜───── - ─── + ── - ── + 1⎟⋅cos(b) - sin(a)⋅sin(b)</span>
<span class="go">⎝40320   720   24   2     ⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosa</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosa</span>
<span class="go">   8      6    4    2</span>
<span class="go">  a      a    a    a</span>
<span class="go">───── - ─── + ── - ── + 1</span>
<span class="go">40320   720   24   2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">cosa</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">-sin(a)⋅sin(b) + cos(a)⋅cos(b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span>
<span class="go">cos(a + b) = -sin(a)⋅sin(b) + cos(a)⋅cos(b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="not-only-symbolics-numerical-computing">
<h3>Not only symbolics: numerical computing<a class="headerlink" href="#not-only-symbolics-numerical-computing" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-numerics-1">
<span id="id19"></span><h4>Solution 1<a class="headerlink" href="#solution-numerics-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)))))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">0.7302900194855046292629153268423316194247957512439873318 - 1.308036181902133609036447992994107130426900293406430474⋅ⅈ</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-numerics-2">
<span id="id20"></span><h4>Solution 2<a class="headerlink" href="#solution-numerics-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">E_million_digits</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi_million_digits</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># We can use the .find() method of str.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># First, let&#39;s see what we should offset the value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (it&#39;s not immediately obvious because of 0 indexing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># and because of the &#39;.&#39; in the string.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_million_digits</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">2.718</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_million_digits</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;71&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># So, counting the 2 as the first digit, we see that</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># there is no need for any offset!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E999999</span> <span class="o">=</span> <span class="n">E_million_digits</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;999999&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E999999</span>
<span class="go">384341</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;...</span><span class="si">%s</span><span class="s">...&quot;</span> <span class="o">%</span> <span class="n">E_million_digits</span><span class="p">[</span><span class="n">E999999</span><span class="p">:</span><span class="n">E999999</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
<span class="go">...9999999951...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># We see that there are actually 8 consecutive 9&#39;s here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi789</span> <span class="o">=</span> <span class="n">pi_million_digits</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;789&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi789</span>
<span class="go">352</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;...</span><span class="si">%s</span><span class="s">...&quot;</span> <span class="o">%</span> <span class="n">pi_million_digits</span><span class="p">[</span><span class="n">pi789</span><span class="p">:</span><span class="n">pi789</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
<span class="go">...7892590360...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Now, double check the values from Dinosaur Comics.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E789</span> <span class="o">=</span> <span class="n">E_million_digits</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;789&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E789</span>
<span class="go">2501</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;...</span><span class="si">%s</span><span class="s">...&quot;</span> <span class="o">%</span> <span class="n">E_million_digits</span><span class="p">[</span><span class="n">E789</span><span class="p">:</span><span class="n">E789</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
<span class="go">...7893652605...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi999999</span> <span class="o">=</span> <span class="n">pi_million_digits</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;999999&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi999999</span>
<span class="go">763</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Hey, this one was wrong in the webcomic (T-Rex said &quot;762nd&quot;)!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;...</span><span class="si">%s</span><span class="s">...&quot;</span> <span class="o">%</span> <span class="n">pi_million_digits</span><span class="p">[</span><span class="n">pi999999</span><span class="p">:</span><span class="n">pi999999</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
<span class="go">...9999998372...</span>
</pre></div>
</div>
</div>
<div class="section" id="solution-3">
<span id="solution-numerics-3"></span><h4>Solution 3<a class="headerlink" href="#solution-3" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">((</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">  -2</span>
<span class="go">─────</span>
<span class="go">  ⎽⎽⎽</span>
<span class="go">╲╱ π</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="summing-roots-of-polynomials">
<h3>Summing roots of polynomials<a class="headerlink" href="#summing-roots-of-polynomials" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-rootsum-1">
<span id="id21"></span><h4>Solution 1<a class="headerlink" href="#solution-rootsum-1" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first"><span class="math">\(f = z^5 + z + a\)</span> and <span class="math">\(g = \frac{1}{z + 1}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">     5</span>
<span class="go">a + z  + z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">  1</span>
<span class="go">─────</span>
<span class="go">z + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;r:5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">together</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span> <span class="p">[</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span>
<span class="go">(r₀ + 1)⋅(r₁ + 1)⋅(r₂ + 1)⋅(r₃ + 1) + (r₀ + 1)⋅(r₁ + 1)⋅(r₂ + 1)⋅(r₄ + 1) + (r₀ + 1)⋅(r₁ + 1)⋅(r₃ + 1)⋅(r₄ + 1) + (r₀ + 1)⋅(r₂ + 1)⋅(r₃ + 1)⋅(r₄ + 1) + (r₁ + 1)⋅(r₂ + 1)⋅(r₃ + 1)⋅(r₄ + 1)</span>
<span class="go">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="go">                                                                        (r₀ + 1)⋅(r₁ + 1)⋅(r₂ + 1)⋅(r₃ + 1)⋅(r₄ + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">viete</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">r₀ + r₁ + r₂ + r₃ + r₄ = 0</span>
<span class="go">r₀⋅r₁ + r₀⋅r₂ + r₀⋅r₃ + r₀⋅r₄ + r₁⋅r₂ + r₁⋅r₃ + r₁⋅r₄ + r₂⋅r₃ + r₂⋅r₄ + r₃⋅r₄ = 0</span>
<span class="go">r₀⋅r₁⋅r₂ + r₀⋅r₁⋅r₃ + r₀⋅r₁⋅r₄ + r₀⋅r₂⋅r₃ + r₀⋅r₂⋅r₄ + r₀⋅r₃⋅r₄ + r₁⋅r₂⋅r₃ + r₁⋅r₂⋅r₄ + r₁⋅r₃⋅r₄ + r₂⋅r₃⋅r₄ = 0</span>
<span class="go">r₀⋅r₁⋅r₂⋅r₃ + r₀⋅r₁⋅r₂⋅r₄ + r₀⋅r₁⋅r₃⋅r₄ + r₀⋅r₂⋅r₃⋅r₄ + r₁⋅r₂⋅r₃⋅r₄ = 1</span>
<span class="go">r₀⋅r₁⋅r₂⋅r₃⋅r₄ = -a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">denom</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">),</span> <span class="n">mapping</span> <span class="o">=</span> <span class="n">symmetrize</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">formal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">(4⋅s₁ + 3⋅s₂ + 2⋅s₃ + s₄ + 5, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span>
<span class="go">(s₁ + s₂ + s₃ + s₄ + s₅ + 1, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">poly</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">s₁ = r₀ + r₁ + r₂ + r₃ + r₄</span>
<span class="go">s₂ = r₀⋅r₁ + r₀⋅r₂ + r₀⋅r₃ + r₀⋅r₄ + r₁⋅r₂ + r₁⋅r₃ + r₁⋅r₄ + r₂⋅r₃ + r₂⋅r₄ + r₃⋅r₄</span>
<span class="go">s₃ = r₀⋅r₁⋅r₂ + r₀⋅r₁⋅r₃ + r₀⋅r₁⋅r₄ + r₀⋅r₂⋅r₃ + r₀⋅r₂⋅r₄ + r₀⋅r₃⋅r₄ + r₁⋅r₂⋅r₃ + r₁⋅r₂⋅r₄ + r₁⋅r₃⋅r₄ + r₂⋅r₃⋅r₄</span>
<span class="go">s₄ = r₀⋅r₁⋅r₂⋅r₃ + r₀⋅r₁⋅r₂⋅r₄ + r₀⋅r₁⋅r₃⋅r₄ + r₀⋅r₂⋅r₃⋅r₄ + r₁⋅r₂⋅r₃⋅r₄</span>
<span class="go">s₅ = r₀⋅r₁⋅r₂⋅r₃⋅r₄</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subslist</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subslist</span>
<span class="go">[(s₁, 0), (s₂, 0), (s₃, 0), (s₄, 1), (s₅, -a)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span>
<span class="go">  6</span>
<span class="go">──────</span>
<span class="go">-a + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Note, we must give a variable to RootSum, as f has more than one Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span> <span class="o">-</span> <span class="n">RootSum</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">z</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first"><span class="math">\(f = z^5 + z + a\)</span> and <span class="math">\(g = \frac{1}{z + b}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">     5</span>
<span class="go">a + z  + z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">  1</span>
<span class="go">─────</span>
<span class="go">b + z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;r:5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">together</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span> <span class="p">[</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span>
<span class="go">(b + r₀)⋅(b + r₁)⋅(b + r₂)⋅(b + r₃) + (b + r₀)⋅(b + r₁)⋅(b + r₂)⋅(b + r₄) + (b + r₀)⋅(b + r₁)⋅(b + r₃)⋅(b + r₄) + (b + r₀)⋅(b + r₂)⋅(b + r₃)⋅(b + r₄) + (b + r₁)⋅(b + r₂)⋅(b + r₃)⋅(b + r₄)</span>
<span class="go">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="go">                                                                        (b + r₀)⋅(b + r₁)⋅(b + r₂)⋅(b + r₃)⋅(b + r₄)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">viete</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">r₀ + r₁ + r₂ + r₃ + r₄ = 0</span>
<span class="go">r₀⋅r₁ + r₀⋅r₂ + r₀⋅r₃ + r₀⋅r₄ + r₁⋅r₂ + r₁⋅r₃ + r₁⋅r₄ + r₂⋅r₃ + r₂⋅r₄ + r₃⋅r₄ = 0</span>
<span class="go">r₀⋅r₁⋅r₂ + r₀⋅r₁⋅r₃ + r₀⋅r₁⋅r₄ + r₀⋅r₂⋅r₃ + r₀⋅r₂⋅r₄ + r₀⋅r₃⋅r₄ + r₁⋅r₂⋅r₃ + r₁⋅r₂⋅r₄ + r₁⋅r₃⋅r₄ + r₂⋅r₃⋅r₄ = 0</span>
<span class="go">r₀⋅r₁⋅r₂⋅r₃ + r₀⋅r₁⋅r₂⋅r₄ + r₀⋅r₁⋅r₃⋅r₄ + r₀⋅r₂⋅r₃⋅r₄ + r₁⋅r₂⋅r₃⋅r₄ = 1</span>
<span class="go">r₀⋅r₁⋅r₂⋅r₃⋅r₄ = -a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">denom</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">),</span> <span class="n">mapping</span> <span class="o">=</span> <span class="n">symmetrize</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">formal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">⎛   4      3         2                    ⎞</span>
<span class="go">⎝5⋅b  + 4⋅b ⋅s₁ + 3⋅b ⋅s₂ + 2⋅b⋅s₃ + s₄, 0⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span>
<span class="go">⎛ 5    4       3       2                  ⎞</span>
<span class="go">⎝b  + b ⋅s₁ + b ⋅s₂ + b ⋅s₃ + b⋅s₄ + s₅, 0⎠</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">poly</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">s₁ = r₀ + r₁ + r₂ + r₃ + r₄</span>
<span class="go">s₂ = r₀⋅r₁ + r₀⋅r₂ + r₀⋅r₃ + r₀⋅r₄ + r₁⋅r₂ + r₁⋅r₃ + r₁⋅r₄ + r₂⋅r₃ + r₂⋅r₄ + r₃⋅r₄</span>
<span class="go">s₃ = r₀⋅r₁⋅r₂ + r₀⋅r₁⋅r₃ + r₀⋅r₁⋅r₄ + r₀⋅r₂⋅r₃ + r₀⋅r₂⋅r₄ + r₀⋅r₃⋅r₄ + r₁⋅r₂⋅r₃ + r₁⋅r₂⋅r₄ + r₁⋅r₃⋅r₄ + r₂⋅r₃⋅r₄</span>
<span class="go">s₄ = r₀⋅r₁⋅r₂⋅r₃ + r₀⋅r₁⋅r₂⋅r₄ + r₀⋅r₁⋅r₃⋅r₄ + r₀⋅r₂⋅r₃⋅r₄ + r₁⋅r₂⋅r₃⋅r₄</span>
<span class="go">s₅ = r₀⋅r₁⋅r₂⋅r₃⋅r₄</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subslist</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subslist</span>
<span class="go">[(s₁, 0), (s₂, 0), (s₃, 0), (s₄, 1), (s₅, -a)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span>
<span class="go">     4</span>
<span class="go">  5⋅b  + 1</span>
<span class="go">───────────</span>
<span class="go">      5</span>
<span class="go">-a + b  + b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Note, we must give a variable to RootSum, as f has more than one Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subslist</span><span class="p">)</span> <span class="o">-</span> <span class="n">RootSum</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">z</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="solution-rootsum-2">
<span id="id22"></span><h4>Solution 2<a class="headerlink" href="#solution-rootsum-2" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="vertex-coloring-of-graphs">
<h3>Vertex <span class="math">\(k\)</span>&#8211;coloring of graphs<a class="headerlink" href="#vertex-coloring-of-graphs" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-colorings-1">
<span id="id23"></span><h4>Solution 1<a class="headerlink" href="#solution-colorings-1" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="solution-colorings-2">
<span id="id24"></span><h4>Solution 2<a class="headerlink" href="#solution-colorings-2" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="algebraic-geometry">
<h3>Algebraic geometry<a class="headerlink" href="#algebraic-geometry" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-geometric-1">
<span id="id25"></span><h4>Solution 1<a class="headerlink" href="#solution-geometric-1" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/sympy-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extras</a><ul>
<li><a class="reference internal" href="#solutions">Solutions</a><ul>
<li><a class="reference internal" href="#arithmetic-operators">Arithmetic operators</a><ul>
<li><a class="reference internal" href="#solution-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-blocks-of-expressions">Building blocks of expressions</a><ul>
<li><a class="reference internal" href="#solution-blocks-1">Solution 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#foreign-types-in-sympy">Foreign types in SymPy</a><ul>
<li><a class="reference internal" href="#solution-foreign-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-foreign-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-role-of-symbols">The role of symbols</a><ul>
<li><a class="reference internal" href="#solution-symbols-1">Solution 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#obtaining-parts-of-expressions">Obtaining parts of expressions</a><ul>
<li><a class="reference internal" href="#solution-parts-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-parts-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#immutability-of-expressions">Immutability of expressions</a><ul>
<li><a class="reference internal" href="#solution-immutability-1">Solution 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#turning-strings-into-expressions">Turning strings into expressions</a><ul>
<li><a class="reference internal" href="#solution-sympify-1">Solution 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-built-in-printers">Customizing built-in printers</a><ul>
<li><a class="reference internal" href="#solution-custom-printers-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-custom-printers-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-printers-from-scratch">Implementing printers from scratch</a><ul>
<li><a class="reference internal" href="#solution-new-printers-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-new-printers-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#code-generation">Code generation</a><ul>
<li><a class="reference internal" href="#solution-codegen-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-codegen-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#partial-fraction-decomposition">Partial fraction decomposition</a><ul>
<li><a class="reference internal" href="#solution-partfrac-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-partfrac-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deriving-trigonometric-identities">Deriving trigonometric identities</a><ul>
<li><a class="reference internal" href="#solution-trig-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-trig-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#not-only-symbolics-numerical-computing">Not only symbolics: numerical computing</a><ul>
<li><a class="reference internal" href="#solution-numerics-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-numerics-2">Solution 2</a></li>
<li><a class="reference internal" href="#solution-3">Solution 3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summing-roots-of-polynomials">Summing roots of polynomials</a><ul>
<li><a class="reference internal" href="#solution-rootsum-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-rootsum-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vertex-coloring-of-graphs">Vertex <span class="math">\(k\)</span>&#8211;coloring of graphs</a><ul>
<li><a class="reference internal" href="#solution-colorings-1">Solution 1</a></li>
<li><a class="reference internal" href="#solution-colorings-2">Solution 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#algebraic-geometry">Algebraic geometry</a><ul>
<li><a class="reference internal" href="#solution-geometric-1">Solution 1</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mathematics.html"
                        title="previous chapter">Mathematical problem solving with SymPy</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/extras.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mathematics.html" title="Mathematical problem solving with SymPy"
             >previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy conference 2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Mateusz Paprocki, Aaron Meurer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1pre/91b4fc984b32.
    </div>
  </body>
</html>